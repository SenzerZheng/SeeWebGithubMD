# 信号
* man 7 signal
## Core dump
* ulimit
```shell
youhuangla@Ubuntu s11 % ulimit -a                                                              [0]
-c: core file size (blocks)         0

```
* set limit of core
```shell
youhuangla@Ubuntu s11 % ulimit -c 1024  #will disappear?标识此core文件的大小不受限制。 在shell里使用命令：ulimit -c unlimited，
#这样进行修改只是对本次会话有效，是临时的，如果想让修改永久生效，则需要修改配置文件，如 .bash_profile、/etc/profile或/etc/security/limits.conf
#https://blog.csdn.net/fengxinze/article/details/6800175
youhuangla@Ubuntu s11 % ulimit -a                                                              [0]
-c: core file size (blocks)         1024

```
### SIGQUIT
* dead loop and send a signal to teminate
```shell
youhuangla@Ubuntu coreOpt % vim deadloop.c                                                     [0]
youhuangla@Ubuntu coreOpt % gcc deadloop.c                                                     [0]
youhuangla@Ubuntu coreOpt % ./a.out

```
* 另一个终端中
```shell
youhuangla@Ubuntu coreOpt % ps uH                                                              [0]
youhuan+ 18602  0.0  0.0   4384   772 pts/0    S+   09:53   0:00 ./a.out
youhuangla@Ubuntu coreOpt % kill -3 18602
```
* kill -3 "./a.out pid" 
即SIGQUIT 信号 bash中 kill -l显示
^\ (Ctrl + "\\\")在Ubuntu中也可以发
```shell
youhuangla@Ubuntu coreOpt % ./a.out                                                            [0]
[1]    18602 quit (core dumped)  ./a.out #see man 7 signal
```
错误信息根据shell不同可能不同，这里是zsh
* 查看core
```shell
youhuangla@Ubuntu coreOpt % ls                                                               [131]
a.out  core  deadloop.c
youhuangla@Ubuntu coreOpt % gdb a.out core
[New LWP 18602]#18602 is process pid
Core was generated by `./a.out'.
Program terminated with signal SIGQUIT, Quit.
#0  0x00007f9644e0c774 in __GI___nanosleep (requested_time=requested_time@entry=0x7ffd242035e0, 
    remaining=remaining@entry=0x7ffd242035e0) at ../sysdeps/unix/sysv/linux/nanosleep.c:28
28	../sysdeps/unix/sysv/linux/nanosleep.c: No such file or directory.

(gdb) bt #to see error
#0  0x00007f9644e0c774 in __GI___nanosleep (requested_time=requested_time@entry=0x7ffd242035e0, 
    remaining=remaining@entry=0x7ffd242035e0) at ../sysdeps/unix/sysv/linux/nanosleep.c:28
#1  0x00007f9644e0c67a in __sleep (seconds=0) at ../sysdeps/posix/sleep.c:55
#2  0x000056509dc24658 in main ()
```
### SIGFPE
* /0 error
```shell
youhuangla@Ubuntu coreOpt % gcc multi0.c                                                       [0]
multi0.c: In function ‘main’:
multi0.c:10:15: warning: division by zero [-Wdiv-by-zero]
     int a = 3 / 0;
               ^
youhuangla@Ubuntu coreOpt % ./a.out                                                            [0]
[1]    18810 floating point exception (core dumped)  ./a.out
youhuangla@Ubuntu coreOpt % gdb a.out core                                                     [0]
[New LWP 18810]
Core was generated by `./a.out'.
Program terminated with signal SIGFPE, Arithmetic exception.
#0  0x000055a11baab609 in main ()

```
### SIGABRT
* double free()
```shell
youhuangla@Ubuntu coreOpt % vim double_free.c                                                  [0]
youhuangla@Ubuntu coreOpt % gcc double_free.c                                                  [0]
youhuangla@Ubuntu coreOpt % ./a.out                                                            [0]
free(): double free detected in tcache 2
[1]    18935 abort (core dumped)  ./a.out
youhuangla@Ubuntu coreOpt % gdb a.out core                                                     [0]
[New LWP 18976]
Core was generated by `./a.out'.
Program terminated with signal SIGABRT, Aborted.
#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51
51	../sysdeps/unix/sysv/linux/raise.c: No such file or directory.
(gdb) bt
#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51
#1  0x00007fd9c1842921 in __GI_abort () at abort.c:79
#2  0x00007fd9c188b967 in __libc_message (action=action@entry=do_abort, 
    fmt=fmt@entry=0x7fd9c19b8b0d "%s\n") at ../sysdeps/posix/libc_fatal.c:181
#3  0x00007fd9c18929da in malloc_printerr (
    str=str@entry=0x7fd9c19ba778 "free(): double free detected in tcache 2") at malloc.c:5342
#4  0x00007fd9c189a20d in _int_free (have_lock=0, p=0x55d7b806e250, 
    av=0x7fd9c1bedc40 <main_arena>) at malloc.c:4195
#5  __GI___libc_free (mem=0x55d7b806e260) at malloc.c:3134
#6  0x000055d7b7e076b8 in main ()

```

### SIGSEGV 
* term1
```shell
youhuangla@Ubuntu coreOpt % gcc deadloop.c                                                     [0]
```
* another terminal
```shell
youhuangla@Ubuntu coreOpt % ps uH       #ps u                                                       [0]
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
youhuan+  5880  0.0  0.4  59168  9628 pts/2    Ss+  Jan14   0:05 -zsh
youhuan+  5989  0.0  0.4  58600  9168 pts/5    Ss+  Jan14   0:02 -zsh
youhuan+ 18180  0.0  0.5  64060 10288 pts/0    Ss   09:23   0:07 -zsh
youhuan+ 18474  0.0  0.4  58556  9148 pts/1    Ss   09:52   0:00 -zsh
youhuan+ 19517  0.0  0.0   4384   716 pts/1    S+   12:14   0:00 ./a.out
youhuan+ 19522  0.0  0.1  37376  3344 pts/0    R+   12:14   0:00 ps uH
youhuangla@Ubuntu coreOpt % kill -SIGSEGV 19517 
```
* term1
```shell
youhuangla@Ubuntu coreOpt % ./a.out                                                            [0]
[1]    19517 segmentation fault  ./a.out
```
## Kill cmd to send signal to proc
```bash
youhuangla@Ubuntu coreOpt % gcc killOpt.c                                                      [0]
youhuangla@Ubuntu coreOpt % ./a.out                                                            [0]
child sleep 1 sec
child sleep 1 sec
child sleep 1 sec
child terminated by signal 3
youhuangla@Ubuntu coreOpt % gdb a.out core
Core was generated by `./a.out'.
Program terminated with signal SIGQUIT, Quit.
#0  0x00007fbf9212d774 in __GI___nanosleep (requested_time=requested_time@entry=0x7ffe75fce830, 
    remaining=remaining@entry=0x7ffe75fce830) at ../sysdeps/unix/sysv/linux/nanosleep.c:28
28	../sysdeps/unix/sysv/linux/nanosleep.c: No such file or directory.
(gdb) bt
#0  0x00007fbf9212d774 in __GI___nanosleep (requested_time=requested_time@entry=0x7ffe75fce830, 
    remaining=remaining@entry=0x7ffe75fce830) at ../sysdeps/unix/sysv/linux/nanosleep.c:28
#1  0x00007fbf9212d67a in __sleep (seconds=0) at ../sysdeps/posix/sleep.c:55
#2  0x0000564a7cc68978 in main ()

```